{
    "collab_server" : "",
    "contents" : "library(reshape2)\nlibrary(dplyr)\nlibrary(xts)\nlibrary(dygraphs)\nlibrary(ggplot2)\nlibrary(qdap)\nsetwd(\"E:/DATA SCIENCE/credihealth/graph data\")\nspeciality_wise<-read.csv(\"speciality_wise.csv\")\ncity_wise<-read.csv(\"city_wise.csv\")\nspeciality_wise[is.na(speciality_wise)]<-0\ncity_wise[is.na(city_wise)]<-0\ndf1<-melt(speciality_wise,id.vars = c(\"Date\",\"Speciality\",\"Category\"))\ndf2<-melt(city_wise,id.vars = c(\"Date\",\"City_Name\",\"Category\"))\ndf1$Date<-as.Date(df1$Date, format=\"%m/%d/%Y\")\ndf2$Date<-as.Date(df2$Date, format=\"%m/%d/%Y\")\n\nrequest<-df1 %>% filter(variable==\"Request\")\nbooking<-df1 %>% filter(variable==\"Booking\")\nopd<-df1 %>% filter(variable==\"OPD\")\nipd<-df1 %>% filter(variable==\"IPD\") \n\nrequest2<-df2 %>% filter(variable==\"Request\")\nbooking2<-df2 %>% filter(variable==\"Booking\")\nopd2<-df2 %>% filter(variable==\"OPD\")\nipd2<-df2 %>% filter(variable==\"IPD\") \n\nshinyServer(\n  function(input,output){\n    selected1 <- reactive({request %>% \n        filter(Speciality==input$Speciality,Category == input$Type) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected2 <- reactive({booking %>% \n        filter(Speciality==input$Speciality,Category == input$Type) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected3 <- reactive({opd %>% \n        filter(Speciality==input$Speciality,Category == input$Type) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected4 <- reactive({ipd %>% \n        filter(Speciality==input$Speciality,Category == input$Type) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected5 <- reactive({request2 %>% \n        filter(City_Name==input$City,Category == input$Category) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected6 <- reactive({booking2 %>% \n        filter(City_Name==input$City,Category == input$Category) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected7 <- reactive({opd2 %>% \n        filter(City_Name==input$City,Category == input$Category) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    selected8 <- reactive({ipd2 %>% \n        filter(City_Name==input$City,Category == input$Category) %>% \n        group_by(Date) %>%\n        summarise(n = value)})\n    \n    \n    output$dygraph<-renderDygraph({\n      spe_xts <- xts(cbind(selected1()$n,selected2()$n,selected3()$n,selected4()$n), order.by = as.Date(selected1()$Date))\n      dygraph(spe_xts,xlab = \"Month (Plot For Speciality_wise)\",ylab = \"Value\")%>%\n        dySeries(\"V1\",label=\"Request\",color=\"red\", fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V2\",label=\"Booking\",color=\"green\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V3\",label=\"OPD\",color=\"purple\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V4\",label=\"IPD\",color=\"orange\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dyLegend(labelsDiv = \"legendDivID\",labelsSeparateLines = T)\n      \n        \n             })\n    \n    output$dygraph2<-renderDygraph({\n      spe_xts2 <- xts(cbind(selected5()$n,selected6()$n,selected7()$n,selected8()$n), order.by = as.Date(selected5()$Date))\n      dygraph(spe_xts2,xlab = \"Month (Plot For City_wise)\",ylab = \"Value\")%>%\n        dySeries(\"V1\",label=\"Request\",color=\"red\", fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V2\",label=\"Booking\",color=\"green\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V3\",label=\"OPD\",color=\"purple\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dySeries(\"V4\",label=\"IPD\",color=\"orange\",fillGraph = F, strokeWidth = 3, drawPoints = T,pointSize=3)%>%\n        dyLegend(labelsDiv = \"legendDivID\",labelsSeparateLines = T)\n      \n    })\n    \n    output$plotgraph1<-renderPlot({\n      \n       \n      hist(selected1()$n,col = \"red\",main = paste(\"Histogram of Request for\",input$Speciality,sep = \" \"),xlab = \"Range\",ylab = \"Number\")\n      \n    })\n    \n    output$plotgraph2<-renderPlot({\n      \n      hist(selected2()$n,col = \"green\",main = paste(\"Histogram of Booking for\",input$Speciality,sep = \" \"),xlab = \"Range\",ylab = \"Number\")\n      \n    })\n      \n    output$plotgraph3<-renderPlot({\n      \n      hist(selected3()$n,col = \"purple\",main = paste(\"Histogram of OPD for\",input$Speciality,sep = \" \"),xlab = \"Range\",ylab = \"Number\")\n      \n    })\n    \n    output$plotgraph4<-renderPlot({\n      \n      hist(selected4()$n,col = \"orange\",main = paste(\"Histogram of IPD for\",input$Speciality,sep = \" \"),xlab = \"Range\",ylab = \"Number\")\n      \n    })\n    \n    output$text1<-renderText({\n      minimum<-min(selected1()$n)\n    })\n  }\n)\n    \n    \n    \n  \n",
    "created" : 1521111109866.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "3499527406",
    "id" : "257A87BE",
    "lastKnownWriteTime" : 1521112304,
    "last_content_update" : 1521112304,
    "path" : "E:/DATA SCIENCE/credihealth/graph data/App2/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}